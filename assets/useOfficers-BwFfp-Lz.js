var u=Object.defineProperty;var g=(s,e,r)=>e in s?u(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var d=(s,e,r)=>g(s,typeof e!="symbol"?e+"":e,r);import{r as a}from"./index-Bl4yh2LS.js";class p{constructor(){d(this,"officers",[]);d(this,"storageKey","nccpd_officers");d(this,"listeners",new Set);const e=localStorage.getItem(this.storageKey);e&&(this.officers=JSON.parse(e))}saveToStorage(){localStorage.setItem(this.storageKey,JSON.stringify(this.officers)),this.notifyListeners()}notifyListeners(){this.listeners.forEach(e=>e())}addChangeListener(e){this.listeners.add(e)}removeChangeListener(e){this.listeners.delete(e)}getOfficers(){return[...this.officers]}getAllOfficers(){return[...this.officers]}async createOfficer(e){const r={id:Math.random().toString(36).substr(2,9),...e};return this.officers.push(r),this.saveToStorage(),r}async updateOfficer(e,r){const o=this.officers.findIndex(n=>n.id===e);if(o===-1)throw new Error("Officer not found");const h={...this.officers[o],...r,id:e};return this.officers[o]=h,this.saveToStorage(),h}async deleteOfficer(e){const r=this.officers.findIndex(o=>o.id===e);if(r===-1)throw new Error("Officer not found");this.officers.splice(r,1),this.saveToStorage()}validateOfficerData(e){const r=[];return e.badgeNumber||r.push("Badge number is required"),e.firstName||r.push("First name is required"),e.lastName||r.push("Last name is required"),e.rank||r.push("Rank is required"),e.zone||r.push("Zone is required"),e.sector||r.push("Sector is required"),e.email&&!this.isValidEmail(e.email)&&r.push("Invalid email format"),e.phone&&!this.isValidPhone(e.phone)&&r.push("Invalid phone format"),r}getOfficersByDistrict(e){return this.officers.filter(r=>r.sector.includes(e))}getCommandStaff(){return this.officers.filter(e=>e.rank.includes("Chief")||e.rank.includes("Captain"))}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){return/^\+?[\d\s-()]{10,}$/.test(e)}}const c=new p,S=()=>{const[s,e]=a.useState([]),[r,o]=a.useState(!0),[h,n]=a.useState(null),f=a.useCallback(()=>{try{const t=c.getOfficers();e(t),n(null)}catch(t){n(t instanceof Error?t:new Error("Failed to fetch officers"))}finally{o(!1)}},[]);return a.useEffect(()=>{f(),c.addChangeListener(f);const t=i=>{i.key==="nccpd_officers"&&f()};return window.addEventListener("storage",t),()=>{c.removeChangeListener(f),window.removeEventListener("storage",t)}},[f]),{officers:s,loading:r,error:h,updateOfficer:async(t,i)=>{try{await c.updateOfficer(t,i),f()}catch(l){throw n(l instanceof Error?l:new Error("Failed to update officer")),l}},deleteOfficer:async t=>{try{await c.deleteOfficer(t),f()}catch(i){throw n(i instanceof Error?i:new Error("Failed to delete officer")),i}},createOfficer:async t=>{try{await c.createOfficer(t),f()}catch(i){throw n(i instanceof Error?i:new Error("Failed to create officer")),i}}}};export{c as o,S as u};
