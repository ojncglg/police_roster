import{r as u,j as e,M as v,n as m,a as z,C as b,I as f,S as N,B as k,w as F,b as I,c as B}from"./index-Bl4yh2LS.js";import{o as S,u as R}from"./useOfficers-BwFfp-Lz.js";import{S as q,i as C,R as H,Z as T,a as V}from"./officer-D71qkpl6.js";const W=({officers:d,onEdit:o,onDelete:j})=>{const[p,t]=u.useState(!1),[i,l]=u.useState(null),g=s=>{l(s),t(!0)},n=()=>{l(null),t(!1)},x=async()=>{if(i)try{await S.deleteOfficer(i.id),j(i),m.success("Officer deleted successfully"),n()}catch{m.error("Failed to delete officer")}},a=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"deployed":return"bg-amber-100 text-amber-800";case"fmla":return"bg-blue-100 text-blue-800";case"tdy":return"bg-purple-100 text-purple-800";case"retired":return"bg-gray-100 text-gray-800";case"adminLeave":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8",children:e.jsx("div",{className:"shadow overflow-hidden border-b border-gray-200 dark:border-gray-700 sm:rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"First Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Last Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Badge Number"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Rank"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Special Assignment"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:d.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.firstName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.lastName})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:s.badgeNumber}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:s.rank}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${a(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:s.specialAssignments.join(", ")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>o(s),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-4",children:"Edit"}),e.jsx("button",{onClick:()=>g(s),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Delete"})]})]},s.id))})]})})})})}),e.jsxs(v,{isOpen:p,onClose:n,title:"Delete Officer",children:[e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this officer? This action cannot be undone."})}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:n,children:"Cancel"}),e.jsx("button",{type:"button",className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",onClick:x,children:"Delete"})]})]})]})},O={firstName:"",lastName:"",badgeNumber:"",rank:"",zone:"",sector:"",isOnDesk:!1,specialAssignment:"",email:"",phone:"",status:"active",notes:"",specialAssignments:[],isActive:!0},A=({initialData:d,onSubmit:o,onCancel:j})=>{const p=d||O,{values:t,errors:i,handleChange:l,handleSubmit:g,setValue:n}=z({initialValues:p,validate:a=>{const s={...O,...a};return S.validateOfficerData(s).map(c=>({field:c.toLowerCase().includes("badge")?"badgeNumber":c.toLowerCase().includes("first name")?"firstName":c.toLowerCase().includes("last name")?"lastName":c.toLowerCase().includes("rank")?"rank":c.toLowerCase().includes("zone")?"zone":c.toLowerCase().includes("sector")?"sector":c.toLowerCase().includes("email")?"email":c.toLowerCase().includes("phone")?"phone":"form",message:c}))},onSubmit:a=>{o(a)}}),x=q.filter(a=>a.zoneId===t.zone);return u.useEffect(()=>{if(!t.zone||!t.sector)return;x.find(s=>s.id===t.sector)||n("sector","")},[t.zone,t.sector,x,n]),u.useEffect(()=>{C(t.rank)?n("sector",""):n("isOnDesk",!1)},[t.rank,n]),e.jsx(b,{className:"max-w-2xl mx-auto",children:e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(f,{label:"Badge Number",name:"badgeNumber",value:t.badgeNumber,onChange:l,error:i.badgeNumber,required:!0}),e.jsx(N,{label:"Rank",name:"rank",value:t.rank,onChange:l,error:i.rank,options:H.map(a=>({value:a,label:a})),required:!0}),e.jsx(f,{label:"First Name",name:"firstName",value:t.firstName,onChange:l,error:i.firstName,required:!0}),e.jsx(f,{label:"Last Name",name:"lastName",value:t.lastName,onChange:l,error:i.lastName,required:!0}),e.jsx(f,{label:"Email",type:"email",name:"email",value:t.email,onChange:l,error:i.email}),e.jsx(f,{label:"Phone",type:"tel",name:"phone",value:t.phone,onChange:l,error:i.phone}),e.jsx(N,{label:"Zone",name:"zone",value:t.zone,onChange:l,error:i.zone,options:T.map(a=>({value:a.id,label:a.name})),required:!0}),e.jsx(N,{label:"Sector",name:"sector",value:t.sector,onChange:l,error:i.sector,options:x.map(a=>({value:a.id,label:a.name})),disabled:!t.zone,required:!0}),C(t.rank)&&e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t.isOnDesk,onChange:a=>n("isOnDesk",a.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Assigned to Desk Duty"})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Assignments"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:V.map(a=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t.specialAssignments.includes(a.id),onChange:s=>{const h=s.target.checked?[...t.specialAssignments,a.id]:t.specialAssignments.filter(c=>c!==a.id);n("specialAssignments",h)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:a.name})]},a.id))})]}),e.jsx(N,{label:"Status",name:"status",value:t.status,onChange:l,options:[{value:"active",label:"Active"},{value:"deployed",label:"Deployed"},{value:"fmla",label:"FMLA"},{value:"tdy",label:"TDY"},{value:"retired",label:"Retired"},{value:"adminLeave",label:"Admin Leave"}],required:!0}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{name:"notes",value:t.notes,onChange:l,rows:3,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(k,{type:"button",variant:"outline",onClick:j,children:"Cancel"}),e.jsx(k,{type:"submit",variant:"primary",children:officer?"Update Officer":"Add Officer"})]})]})})},$=()=>{const{user:d}=I(),{officers:o,loading:j,error:p,updateOfficer:t,deleteOfficer:i,createOfficer:l}=R(),[g,n]=u.useState(!1),[x,a]=u.useState(!1),[s,h]=u.useState(null);p&&m.error("Failed to load officers");const c=r=>{h(r),n(!0)},D=async r=>{try{await i(r.id),m.success("Officer deleted successfully")}catch{m.error("Failed to delete officer")}},L=()=>{a(!0)},w=async r=>{try{s?(await t(s.id,r),n(!1),h(null),m.success("Officer updated successfully")):(await l(r),a(!1),m.success("Officer created successfully"))}catch{m.error("Failed to save officer")}},M=r=>({firstName:r.firstName,lastName:r.lastName,badgeNumber:r.badgeNumber,rank:r.rank,zone:r.zone,sector:r.sector,isOnDesk:r.isOnDesk,specialAssignment:r.specialAssignment||"",email:r.email||"",phone:r.phone||"",status:r.status,notes:r.notes||"",specialAssignments:r.specialAssignments,isActive:r.isActive}),y=()=>{n(!1),a(!1),h(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-police-black to-gray-800 rounded-lg shadow-lg p-6 text-white",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-2",children:["Welcome, ",d==null?void 0:d.username]}),e.jsx("p",{className:"text-gray-300",children:"Manage officer information and assignments in the NCCPD roster system."})]}),e.jsxs(b,{children:[e.jsx(B,{title:"Officer Management",subtitle:"Add, edit, and manage officer information",action:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(k,{variant:"primary",onClick:L,icon:e.jsxs("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-labelledby":"add-officer-icon",children:[e.jsx("title",{id:"add-officer-icon",children:"Add New Officer"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})]}),children:"Add Officer"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Last login: ",new Date((d==null?void 0:d.lastLogin)||"").toLocaleString()]})]})}),e.jsx("div",{className:"mt-4",children:e.jsx(W,{officers:o,onEdit:c,onDelete:D})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(b,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Active Officers"}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-8 h-8 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-labelledby":"active-officers-icon",role:"img",children:[e.jsx("title",{id:"active-officers-icon",children:"Active Officers Icon"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"text-3xl font-bold",children:o.filter(r=>r.isActive).length})]})]})}),e.jsx(b,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"On Duty Today"}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-8 h-8 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-labelledby":"on-duty-icon",role:"img",children:[e.jsx("title",{id:"on-duty-icon",children:"On Duty Officers Icon"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]}),e.jsx("span",{className:"text-3xl font-bold",children:o.filter(r=>r.status==="active").length})]})]})}),e.jsx(b,{className:"bg-gradient-to-br from-yellow-500 to-yellow-600 text-white",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Special Assignments"}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-8 h-8 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-labelledby":"special-assignments-icon",role:"img",children:[e.jsx("title",{id:"special-assignments-icon",children:"Special Assignments Icon"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]}),e.jsx("span",{className:"text-3xl font-bold",children:o.filter(r=>r.specialAssignments.length>0).length})]})]})})]}),e.jsx(v,{isOpen:g,onClose:y,title:`Edit Officer: ${s==null?void 0:s.firstName} ${s==null?void 0:s.lastName}`,children:s&&e.jsx(A,{initialData:s?M(s):void 0,onSubmit:w,onCancel:y})}),e.jsx(v,{isOpen:x,onClose:y,title:"Add New Officer",children:e.jsx(A,{onSubmit:w,onCancel:y})})]})},K=F($);export{K as default};
