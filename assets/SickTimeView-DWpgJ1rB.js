var I=Object.defineProperty;var F=(r,t,a)=>t in r?I(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a;var N=(r,t,a)=>F(r,typeof t!="symbol"?t+"":t,a);import{r as S,j as e,h as A,p as R,B as p,C as L,M as $,n as T}from"./index-Bl4yh2LS.js";import{u as E,o as C}from"./useOfficers-BwFfp-Lz.js";const W=({selectedDates:r,onSelectDate:t,className:a=""})=>{const[s,n]=S.useState(new Date),m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],j=(l=>{const c=l.getFullYear(),u=l.getMonth(),v=new Date(c,u,1),h=new Date(c,u+1,0).getDate(),D=v.getDay(),x=new Date,f=[],M=new Date(c,u,0).getDate();for(let o=D-1;o>=0;o--){const d=new Date(c,u-1,M-o);f.push({date:d,isCurrentMonth:!1,isToday:!1,isSelected:r.some(y=>y.toISOString().split("T")[0]===d.toISOString().split("T")[0])})}for(let o=1;o<=h;o++){const d=new Date(c,u,o);f.push({date:d,isCurrentMonth:!0,isToday:d.toDateString()===x.toDateString(),isSelected:r.some(y=>y.toISOString().split("T")[0]===d.toISOString().split("T")[0])})}const O=42-f.length;for(let o=1;o<=O;o++){const d=new Date(c,u+1,o);f.push({date:d,isCurrentMonth:!1,isToday:!1,isSelected:r.some(y=>y.toISOString().split("T")[0]===d.toISOString().split("T")[0])})}return f})(s),k=()=>{n(new Date(s.getFullYear(),s.getMonth()-1,1))},b=()=>{n(new Date(s.getFullYear(),s.getMonth()+1,1))};return e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow p-4 ${a}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:[A(s)," ",s.getFullYear()]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:k,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded","aria-label":"Previous month",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("title",{children:"Previous month"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})]})}),e.jsx("button",{onClick:b,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded","aria-label":"Next month",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("title",{children:"Next month"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})]})})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:m.map(l=>e.jsx("div",{className:"text-center text-xs font-medium text-gray-600 dark:text-gray-400",children:l.charAt(0)},l))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:j.map((l,c)=>e.jsx("button",{onClick:()=>t(l.date),className:`
              aspect-square flex items-center justify-center text-sm rounded-full
              ${l.isCurrentMonth?"text-gray-900 dark:text-gray-100":"text-gray-400 dark:text-gray-600"}
              ${l.isToday?"bg-police-yellow text-black font-bold":""}
              ${l.isSelected?"ring-2 ring-police-yellow bg-police-yellow/20":""}
              hover:bg-gray-100 dark:hover:bg-gray-700
              transition-colors duration-200
            `,children:l.date.getDate()},c))})]})},w=({allowMultipleDates:r=!1,onSubmit:t,onCancel:a})=>{const{officers:s}=E(),[n,m]=S.useState(""),[g,j]=S.useState([]),[k,b]=S.useState(""),l=i=>{i.preventDefault(),t({officerId:n,dates:g,notes:k.trim()||void 0})},c=i=>{j(r?h=>h.some(x=>x.toISOString().split("T")[0]===i.toISOString().split("T")[0])?h.filter(x=>x.toISOString().split("T")[0]!==i.toISOString().split("T")[0]):[...h,i]:[i])},u=i=>{m(i.target.value)},v=s.map(i=>({value:i.id,label:`${i.lastName}, ${i.firstName} (${i.badgeNumber})`}));return e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select Officer"}),e.jsx(R,{options:[{value:"",label:"Select an officer"},...v],value:n,onChange:u,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r?"Select Dates":"Select Date"}),e.jsx("div",{className:"mt-1",children:e.jsx(W,{selectedDates:g,onSelectDate:c,className:"w-full"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:k,onChange:i=>b(i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-police-yellow focus:border-police-yellow dark:bg-gray-700 dark:border-gray-600 dark:text-white",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(p,{variant:"outline",onClick:a,children:"Cancel"}),e.jsx(p,{type:"submit",disabled:!n||g.length===0,children:"Submit"})]})]})},z=({onSubmit:r,onCancel:t})=>e.jsx(w,{allowMultipleDates:!1,onSubmit:r,onCancel:t}),B=({onSubmit:r,onCancel:t})=>e.jsx(w,{allowMultipleDates:!0,onSubmit:r,onCancel:t}),Y=({onSubmit:r,onCancel:t})=>e.jsx(w,{allowMultipleDates:!0,onSubmit:r,onCancel:t});class q{constructor(){N(this,"sickTimeRecords",[])}generateId(){return Math.random().toString(36).substr(2,9)}async createSickTimeRecord(t,a){const s=C.getOfficers().find(m=>m.id===a.officerId);if(!s)throw new Error("Officer not found");await C.updateOfficer(s.id,{firstName:s.firstName,lastName:s.lastName,badgeNumber:s.badgeNumber,rank:s.rank,zone:s.zone,sector:s.sector,isOnDesk:s.isOnDesk,specialAssignment:s.specialAssignment||"",email:s.email||"",phone:s.phone||"",status:t,notes:s.notes||"",specialAssignments:s.specialAssignments,isActive:s.isActive});const n={id:this.generateId(),officerId:a.officerId,type:t,dates:a.dates,notes:a.notes,createdAt:new Date,updatedAt:new Date};return this.sickTimeRecords.push(n),n}getSickTimeRecords(){return this.sickTimeRecords}getOfficerSickTimeRecords(t){return this.sickTimeRecords.filter(a=>a.officerId===t)}}const P=new q,J=()=>{const[r,t]=S.useState(null),a=async(n,m)=>{if(n)try{await P.createSickTimeRecord(n,m),T.success("Record created successfully"),t(null)}catch(g){T.error(g instanceof Error?g.message:"Failed to create record")}},s=()=>{switch(r){case"sick":return e.jsx(z,{onSubmit:n=>a("sick",n),onCancel:()=>t(null)});case"fmla":return e.jsx(B,{onSubmit:n=>a("fmla",n),onCancel:()=>t(null)});case"injury":return e.jsx(Y,{onSubmit:n=>a("injury",n),onCancel:()=>t(null)});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Sick Time Management"})}),e.jsx(L,{children:e.jsx("div",{className:"p-6 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(p,{variant:"primary",size:"large",fullWidth:!0,onClick:()=>t("sick"),children:"Sick Call Out"}),e.jsx(p,{variant:"primary",size:"large",fullWidth:!0,onClick:()=>t("fmla"),children:"FMLA"}),e.jsx(p,{variant:"primary",size:"large",fullWidth:!0,onClick:()=>t("injury"),children:"Injury on Duty"})]})})}),e.jsx($,{isOpen:r!==null,onClose:()=>t(null),title:r==="sick"?"Sick Call Out":r==="fmla"?"FMLA Request":r==="injury"?"Injury on Duty Report":"",children:s()})]})};export{J as default};
